<!DOCTYPE html>

<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title><机器学习实战>学习笔记之NaiveBayes|Jimersy Lee's Blog </title>
    
    <meta name="keywords" content="PYTHON,MACHINE-LEARNING,python,Jimersy Lee,jimersylee,java,php,python,js,html,github">
	<meta name="description" content="朴素贝叶斯,使用Python进行恶意留言分类,区域分析,垃圾邮件识别">
    <link rel="stylesheet" type="text/css" href="http://local.v4.blog.com/theme/beach/css/style.css?ver=2.3.2">
    <link rel="stylesheet" type="text/css" href="http://local.v4.blog.com/theme/beach/css/markdown.css?ver=2.3.2">
    <link rel="alternate" type="application/rss+xml" title="Jimersy Lee's Blog" href="http://local.v4.blog.com/feed.xml" />
    
    <!--[if IE]>
	<script src="//cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<![endif]-->
	
    <!--[if IE 6]>
	<script src="http://local.v4.blog.com/theme/beach/js/belatedPNG.js"></script>
	<script>
    	DD_belatedPNG.fix('*');
	</script>
	<![endif]-->
	
	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?3f9957e676a9733fcd02eb9f0e5f9416";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>
	</head>

<body>
    <section id="page">
        <div id="pagewrap">
        		<section id="sidebar">
	    <h2>分类</h2>
    <ul>
            <li>
            <a href="http://local.v4.blog.com/category/linux.html">linux</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/python.html">python</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/js.html">js</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/devops.html">devops</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/spring.html">spring</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/go.html">go</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/thoughts.html">thoughts</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/books.html">books</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/java.html">java</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/php.html">php</a>
        </li>
        </ul>
        
        <h2>标签</h2>
    <ul>
            <li>
            <a href="http://local.v4.blog.com/tags/LINUX.html">LINUX</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SHORTCUT-KEY.html">SHORTCUT-KEY</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/CENTOS.html">CENTOS</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/MANJARO.html">MANJARO</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/fusuma.html">fusuma</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/VIM.html">VIM</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SPACEVIM.html">SPACEVIM</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/PYTHON.html">PYTHON</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/MACHINE-LEARNING.html">MACHINE-LEARNING</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SCRAPY.html">SCRAPY</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/CRAWLER.html">CRAWLER</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/JS.html">JS</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/JAVASCRIPT.html">JAVASCRIPT</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/NGINX.html">NGINX</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SSL.html">SSL</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/JENKINS.html">JENKINS</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/HARBOR.html">HARBOR</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/DEVOPS.html">DEVOPS</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/MARIADB.html">MARIADB</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/Spring.html">Spring</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/Cloud.html">Cloud</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/%E7%AE%80%E4%BB%8B.html">简介</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SPRING-CLOUD.html">SPRING-CLOUD</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/GO.html">GO</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/Blog.html">Blog</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/BLOG.html">BLOG</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/DEV.html">DEV</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/RULE.html">RULE</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/ML.html">ML</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/BOOKS.html">BOOKS</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/BACK-END.html">BACK-END</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/JAVA.html">JAVA</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/PATTERN.html">PATTERN</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/JVM.html">JVM</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/PHP.html">PHP</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SWOOLE.html">SWOOLE</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/STRING.html">STRING</a>
        </li>
        </ul>
        
        <h2>归档</h2>
    <ul>
            <li>
            <a href="http://local.v4.blog.com/archive/202006.html">2020-06</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/202005.html">2020-05</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/202002.html">2020-02</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201809.html">2018-09</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201709.html">2017-09</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201707.html">2017-07</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201704.html">2017-04</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201608.html">2016-08</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201607.html">2016-07</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201605.html">2016-05</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201510.html">2015-10</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201508.html">2015-08</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201507.html">2015-07</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201505.html">2015-05</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201504.html">2015-04</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201503.html">2015-03</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201411.html">2014-11</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201408.html">2014-08</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201407.html">2014-07</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201401.html">2014-01</a>
        </li>
        </ul>
    </section>        	<section id="contents">
	<header id="mainheader">
		<h1><a href="http://local.v4.blog.com/"><span>Jimersy Lee's Blog</span></a></h1>
	</header>
	
	<section id="main">
	<article class="post">
    <header>
    	        <h2><机器学习实战>学习笔记之NaiveBayes</h2>
		        <p class="postinfo">PYTHON,MACHINE-LEARNING,python | <time>2016-05-22</time> | by <i>Jimersy Lee</i></p>
    </header>

    <section class="entry">
        <p>
        		<!--
author: Jimersy Lee
head: 
date: 2016-05-22
title: <机器学习实战>学习笔记之NaiveBayes
tags: PYTHON,MACHINE-LEARNING
images: 
category: python
status: publish
summary: 朴素贝叶斯,使用Python进行恶意留言分类,区域分析,垃圾邮件识别
-->
<p>项目地址:<a href="http://github.com/jimersylee/MachineLearningAction">http://github.com/jimersylee/MachineLearningAction</a></p>
<h3>基于概率论的分类方法</h3>
<h4>朴素贝叶斯</h4>
<ul>
<li>使用概率分布进行分类</li>
<li>学习朴素贝叶斯分类器</li>
<li>解析RSS源数据</li>
<li>使用朴素贝叶斯来分析不同地区的态度</li>
</ul>
<h4>朴素贝叶斯</h4>
<p>优点:在数据较少的情况下仍然有效,可以处理多类别问题
缺点:对于输入数据的准备方式较为敏感
使用数据类型:标称型数据</p>
<h4>贝叶斯决策理论的核心思想--即选择具有最高概率的决策</h4>
<h2>条件概率</h2>
<p>P(A|B)=$$\underline{P(AB)}\P(B)$$</p>
<h3>使用贝叶斯准则,进行条件与结果的互换计算</h3>
<p>已知P(A|B),求P(B|A)</p>
<p>P(B|A)=$$\underline{P(A|B)P(B)}\P(A)$$</p>
<p>推导</p>
<blockquote>
<p>给定某个点(x,y),那么该点来自$$c_i$$的概率为P($$c_i$$|x,y)</p>
</blockquote>
<p>P($$c_i$$|x,y)=$$\underline{P(x,y|c_i)P(c_i)}\P(x,y)$$</p>
<p>结论</p>
<blockquote>
<p>如果$$P(c_1|x,y)&gt;P(c_2|x,y)$$,那么(x,y)属于$$c_1$$
如果$$P(c_2|x,y)&gt;P(c_1|x,y)$$,那么(x,y)属于$$c_2$$</p>
</blockquote>
<h3>使用朴素贝叶斯进行文档分类</h3>
<p>朴素贝叶斯是贝叶斯分类器的一个扩展,是用于文档分类的常用算法
朴素贝叶斯的一帮过程</p>
<ol>
<li>收集数据:可以使用任何方法,本章使用RSS源</li>
<li>准备数据:需要数值型或者布尔型数据</li>
<li>分析数据:有大量特征时,绘制特征作用不大,此时使用直方图效果较好</li>
<li>训练算法:计算不同的独立特征的条件概率</li>
<li>测试算法:计算错误率</li>
<li>使用算法:一个常见的朴素贝叶斯应用是文档分类.可以在任意的分类场景中使用朴素贝叶斯分类器,不一定非要是文本.</li>
</ol>
<p>假设词汇表有1000个单词,要得到好的概率分布,需要足够的样本,假设样本数为N</p>
<blockquote>
<p>由统计学知,如果每个特征需要N个样本,那么对于x个特征,将需要$$N^x$$个样本</p>
</blockquote>
<p>对于1000个特征的词汇表将需要$$N^{1000}$$个样本,可以看到,所需要的样本数会随着特征数目的增大而迅速增长
如果特征之间项目独立,那么样本数就能从$$N^{1000}$$减少到N*1000.所谓独立,指的是<strong>统计学上的独立,即一个特征或者单词出现的可能性与它和其他相邻单词没关系</strong></p>
<h4>示例:使用Python进行恶意留言分类</h4>
<p>当论坛中用户发表评论时,总会存在一些恶意言论,如何识别是否为恶意评论,而不让其发送呢?</p>
<ol>
<li>准备数据:从文本中构建词向量,详见bayes.py中的 createVocabList setOfWords2Vec</li>
<li>训练算法:从词向量计算概率</li>
</ol>
<p>重写贝叶斯准则,将之前的x,y替换为<em>w</em>,粗体<em>w</em>表示一个向量,即它是由多个数值组成.在这个例子中,数值个数与词汇表中的词个数相同
P($$c_i$$|w)=$$\underline{P(w|c_i)P(c_i)}\P(w)$$
如何计算?首先通过类别i(侮辱性或者非侮辱性留言)中的文档数除以总的文档数的计算概率p($$c_i$$),接下来计算P($$c_i$$|w),这里就用到了朴素贝叶斯假设</p>
<blockquote>
<p>如果将w展开为一个个独立特征,那么可以将上述概率写做P($$w_0$$,$$w_1$$,...,$$w_N$$|$$c_i$$).这里假设所有事件都独立,它意味着可以使用P($$w_0$$|$$c_i$$)P($$w_1$$|$$c_i$$)...P($$w_N$$|$$c_i$$)来计算概率,这极大地简化了计算过程
该函数的伪代码如下
计算每个类别中的文档数目
对每篇训练文档:</p>
</blockquote>
<p>对每个类别:
如果词条出现文档中-&gt;增加该词条的计数值
增加所有词条的计数值
对每个类别:
对每个词条:
将该词条的数目除以总词条数目得到条件概率
返回每个类别的条件概率</p>
<ol start="3">
<li>
<p>测试算法:根据现实情况修改分类器
利用贝叶斯分类器进行分类时,要计算多个概率的乘积,如果其中一个概率值为0,那么最后的乘积也是0.为降低这种影响,可以将所有的词的出现数初始化为1,并将分母初始化为2</p>
</li>
<li>
<p>准备数据:文档词袋模型
目前为止,我们将每个词的出现与否作为一个特征,这可以被描述为<strong>词集模型(set-of-words-model)</strong>.如果一个词在文档中出现不止一次,这可能意味着包含该词是否出现在文档中所不能表达的某种信息,这种方法被成为<strong>词袋模型(bag-of-words-model)</strong>.在词袋中,每个单词可以出现多次,而在词集中,每个词只出现一次.为适应词袋模型,需要对函数setOfWords2Vec()稍作修改,修改后的函数称为bagOfWords2Vec()</p>
</li>
</ol>
<h4>示例:使用朴素贝叶斯过滤垃圾邮件</h4>
<p>邮件经常收到一些广告邮件,如何将广告邮件识别出来呢?</p>
<ol>
<li>收集数据:提供文本文件</li>
<li>准备数据:将文本解析成词条向量</li>
<li>分析数据:检查词条确保解析的正确性</li>
<li>训练算法:使用我们之前建立的trainNormalBayes0()函数</li>
<li>测试算法:使用classifyNormal(),并且构建一个新的测试函数来计算文档集的错误率</li>
<li>使用算法:构建一个完整的程序对一组文档进行分类,将错误分类的文档输出到屏幕上</li>
</ol>
<h4>示例:使用朴素贝叶斯分类器从个人广告中获取区域倾向</h4>
				</p>
    </section>
</article>	<section id="comments">
				<div class="post-content">
			<div id="disqus_thread"></div>
			<script>
var disqus_config = function () {
	this.page.url = location.href;
	this.page.identifier = '4df6f09486f90d01d5a1d98168eafc38';
};
(function() {
	var d = document, s = d.createElement('script');
	s.src = '//jimersylee.disqus.com/embed.js';
	s.setAttribute('data-timestamp', +new Date());
	(d.head || d.body).appendChild(s);
})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		</div>
			</section>
</section>
    
    <footer id="pagefooter">
    <div class="footerwrap">
        <p class="siteinfo">Copyright &copy 2015 Gtiblog. All Rights Reserved. <a href="http://www.gitblog.cn">Proudly powered by Gitblog</a></p>
    </div>
</footer> 
</section>
        	<div class="clear"></div>
        </div>
    </section>

<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/8.6/styles/magula.min.css">
<script src="//cdn.bootcss.com/highlight.js/8.6/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</body>
</html>
