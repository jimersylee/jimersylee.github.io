<!DOCTYPE html>

<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title><机器学习实战>学习笔记之KNN-约会数据识别|Jimersy Lee's Blog </title>
    
    <meta name="keywords" content="PYTHON,MACHINE-LEARNING,python,Jimersy Lee,jimersylee,java,php,python,js,html,github">
	<meta name="description" content="约会数据分类识别">
    <link rel="stylesheet" type="text/css" href="http://local.v4.blog.com/theme/beach/css/style.css?ver=2.3.2">
    <link rel="stylesheet" type="text/css" href="http://local.v4.blog.com/theme/beach/css/markdown.css?ver=2.3.2">
    <link rel="alternate" type="application/rss+xml" title="Jimersy Lee's Blog" href="http://local.v4.blog.com/feed.xml" />
    
    <!--[if IE]>
	<script src="//cdn.bootcss.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<![endif]-->
	
    <!--[if IE 6]>
	<script src="http://local.v4.blog.com/theme/beach/js/belatedPNG.js"></script>
	<script>
    	DD_belatedPNG.fix('*');
	</script>
	<![endif]-->
	
	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?3f9957e676a9733fcd02eb9f0e5f9416";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>
	</head>

<body>
    <section id="page">
        <div id="pagewrap">
        		<section id="sidebar">
	    <h2>分类</h2>
    <ul>
            <li>
            <a href="http://local.v4.blog.com/category/linux.html">linux</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/python.html">python</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/js.html">js</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/devops.html">devops</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/spring.html">spring</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/go.html">go</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/thoughts.html">thoughts</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/books.html">books</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/java.html">java</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/category/php.html">php</a>
        </li>
        </ul>
        
        <h2>标签</h2>
    <ul>
            <li>
            <a href="http://local.v4.blog.com/tags/LINUX.html">LINUX</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SHORTCUT-KEY.html">SHORTCUT-KEY</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/CENTOS.html">CENTOS</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/MANJARO.html">MANJARO</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/fusuma.html">fusuma</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/VIM.html">VIM</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SPACEVIM.html">SPACEVIM</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/PYTHON.html">PYTHON</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/MACHINE-LEARNING.html">MACHINE-LEARNING</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SCRAPY.html">SCRAPY</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/CRAWLER.html">CRAWLER</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/JS.html">JS</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/JAVASCRIPT.html">JAVASCRIPT</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/NGINX.html">NGINX</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SSL.html">SSL</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/JENKINS.html">JENKINS</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/HARBOR.html">HARBOR</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/DEVOPS.html">DEVOPS</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/MARIADB.html">MARIADB</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/Spring.html">Spring</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/Cloud.html">Cloud</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/%E7%AE%80%E4%BB%8B.html">简介</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SPRING-CLOUD.html">SPRING-CLOUD</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/GO.html">GO</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/Blog.html">Blog</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/BLOG.html">BLOG</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/DEV.html">DEV</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/RULE.html">RULE</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/ML.html">ML</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/BOOKS.html">BOOKS</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/BACK-END.html">BACK-END</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/JAVA.html">JAVA</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/PATTERN.html">PATTERN</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/JVM.html">JVM</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/PHP.html">PHP</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/SWOOLE.html">SWOOLE</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/tags/STRING.html">STRING</a>
        </li>
        </ul>
        
        <h2>归档</h2>
    <ul>
            <li>
            <a href="http://local.v4.blog.com/archive/202006.html">2020-06</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/202005.html">2020-05</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/202002.html">2020-02</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201809.html">2018-09</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201709.html">2017-09</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201707.html">2017-07</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201704.html">2017-04</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201608.html">2016-08</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201607.html">2016-07</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201605.html">2016-05</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201510.html">2015-10</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201508.html">2015-08</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201507.html">2015-07</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201505.html">2015-05</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201504.html">2015-04</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201503.html">2015-03</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201411.html">2014-11</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201408.html">2014-08</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201407.html">2014-07</a>
        </li>
            <li>
            <a href="http://local.v4.blog.com/archive/201401.html">2014-01</a>
        </li>
        </ul>
    </section>        	<section id="contents">
	<header id="mainheader">
		<h1><a href="http://local.v4.blog.com/"><span>Jimersy Lee's Blog</span></a></h1>
	</header>
	
	<section id="main">
	<article class="post">
    <header>
    	        <h2><机器学习实战>学习笔记之KNN-约会数据识别</h2>
		        <p class="postinfo">PYTHON,MACHINE-LEARNING,python | <time>2016-05-04</time> | by <i>Jimersy Lee</i></p>
    </header>

    <section class="entry">
        <p>
        		<!--
author: Jimersy Lee
head: 
date: 2016-05-04
title: <机器学习实战>学习笔记之KNN-约会数据识别
tags: PYTHON,MACHINE-LEARNING
images: 
category: python
status: publish
summary: 约会数据分类识别
-->
<p>项目地址:<a href="http://github.com/jimersylee/MachineLearningAction">http://github.com/jimersylee/MachineLearningAction</a></p>
<pre><code># -*- coding: utf-8 -*-
"""
约会数据kNN
"""

from numpy import *
import matplotlib.pyplot as plt
import operator

def classify0(inX, dataSet, labels, k):
    dataSetSize = dataSet.shape[0]
    diffMat = tile(inX, (dataSetSize, 1)) - dataSet
    sqDiffMat = diffMat ** 2
    sqDistances = sqDiffMat.sum(axis=1)
    distances = sqDistances ** 0.5
    sortedDistIndicies = distances.argsort()
    classCount = {}
    for i in range(k):
        voteIlabel = labels[sortedDistIndicies[i]]
        classCount[voteIlabel] = classCount.get(voteIlabel, 0) + 1
    sortedClassCount = sorted(classCount.iteritems(), key=operator.itemgetter(1), reverse=True)
    return sortedClassCount[0][0]

def file2matrix(filename):
    fr = open(filename)
    numberOfLines = len(fr.readlines())  # get the number of lines in the file
    returnMat = zeros((numberOfLines, 3))  # prepare matrix to return
    classLabelVector = []  # prepare labels return
    fr = open(filename)
    index = 0
    for line in fr.readlines():
        line = line.strip()
        listFromLine = line.split('\t')
        returnMat[index, :] = listFromLine[0:3]
        classLabelVector.append(int(listFromLine[-1]))
        index += 1
    return returnMat, classLabelVector

def autoNorm(dataSet):
    """
    归一化数值
    因为计算距离的时候,差值最大的属性对计算结果的影响最大,如果对于此数据,我们认为权重一样,则需要将数据进行处理,将数值归一化
    将属性的取值范围处理为0到1或者-1到1,使用下面的公式
    newValue=(oldValue-min)/(max-min)
    :param dataSet:矩阵
    :return:normDataSet:归一化后的矩阵
            range:取值范围
            minVals:最小值
    """
    minVals = dataSet.min(0)  # 0代表第一列,取得第一列最小值
    maxVals = dataSet.max(0)  # 取得第一列最大值
    ranges = maxVals - minVals  # 可能的取值范围
    normDataSet = zeros(shape(dataSet))  # 创建新的返回矩阵
    m = dataSet.shape[0]
    normDataSet = dataSet - tile(minVals, (m, 1))
    normDataSet = normDataSet / tile(ranges, (m, 1))  # element wise divide
    return normDataSet, ranges, minVals

def datingClassTest():
    hoRatio = 0.50  # hold out 10%
    datingDataMat, datingLabels = file2matrix('datingData/datingTestSet2.txt')  # load data setfrom file
    normMat, ranges, minVals = autoNorm(datingDataMat)
    m = normMat.shape[0]
    numTestVecs = int(m * hoRatio)
    errorCount = 0.0
    for i in range(numTestVecs):
        classifierResult = classify0(normMat[i, :], normMat[numTestVecs:m, :], datingLabels[numTestVecs:m], 3)
        print "the classifier came back with: %d, the real answer is: %d" % (classifierResult, datingLabels[i])
        if (classifierResult != datingLabels[i]): errorCount += 1.0
    print "the total error rate is: %f" % (errorCount / float(numTestVecs))
    print errorCount

def showNormal():
    """
    最基本散点图
    没有样本类别标签的约会数据散点图.难以辨识途中的点究竟属于那个样本分类
    :return:
    """
    datingDataMat, datingLables = file2matrix('datingData/datingTestSet2.txt')
    fig = plt.figure()
    ax = fig.add_subplot(111)
    ax.scatter(datingDataMat[:, 1], datingDataMat[:, 2])
    plt.xlabel("Percentage of Time Spent Playing Video Games")
    plt.ylabel("Liters of Icc Cream Consumed Per Week")
    plt.show()

def showLable():
    """
    带有样本分类标签的约会数据散点图
    虽然能够比较容易区分数据点丛书类别,但依然很那根据这张图得出结论性信息
    :return:
    """
    datingDataMat, datingLables = file2matrix('datingData/datingTestSet2.txt')
    fig = plt.figure()
    ax = fig.add_subplot(111)
    ax.scatter(datingDataMat[:, 1], datingDataMat[:, 2], 15.0 * array(datingLables), 15.0 * array(datingLables))
    ax.axis([-2, 25, -0.2, 2.0])
    plt.xlabel("Percentage of Time Spent Playing Video Games")
    plt.ylabel("Liters of Icc Cream Consumed Per Week")
    plt.show()

def showClass():
    """
    显示不同的分类
    标识了三个不同的样本分类区域,具有不同爱好的人其类别区域也不同
    每年赢得的飞行常客里程数与玩游戏视频游戏所占百分比的约会数据散点图
    约会数据有三个分类标签,通过途中展示的两个特征更容易区分数据点从属的类别
    :return:
    """

    n = 1000  # number of points to create
    xcord1 = [];
    ycord1 = []
    xcord2 = [];
    ycord2 = []
    xcord3 = [];
    ycord3 = []
    markers = []
    colors = []
    fw = open('datingData/datingTestSet.txt', 'w')
    for i in range(n):
        [r0, r1] = random.standard_normal(2)
        myClass = random.uniform(0, 1)
        if (myClass &lt;= 0.16):
            fFlyer = random.uniform(22000, 60000)
            tats = 3 + 1.6 * r1
            markers.append(20)
            colors.append(2.1)
            classLabel = 1  # 'didntLike'
            xcord1.append(fFlyer);
            ycord1.append(tats)
        elif ((myClass &gt; 0.16) and (myClass &lt;= 0.33)):
            fFlyer = 6000 * r0 + 70000
            tats = 10 + 3 * r1 + 2 * r0
            markers.append(20)
            colors.append(1.1)
            classLabel = 1  # 'didntLike'
            if (tats &lt; 0): tats = 0
            if (fFlyer &lt; 0): fFlyer = 0
            xcord1.append(fFlyer);
            ycord1.append(tats)
        elif ((myClass &gt; 0.33) and (myClass &lt;= 0.66)):
            fFlyer = 5000 * r0 + 10000
            tats = 3 + 2.8 * r1
            markers.append(30)
            colors.append(1.1)
            classLabel = 2  # 'smallDoses'
            if (tats &lt; 0): tats = 0
            if (fFlyer &lt; 0): fFlyer = 0
            xcord2.append(fFlyer);
            ycord2.append(tats)
        else:
            fFlyer = 10000 * r0 + 35000
            tats = 10 + 2.0 * r1
            markers.append(50)
            colors.append(0.1)
            classLabel = 3  # 'largeDoses'
            if (tats &lt; 0): tats = 0
            if (fFlyer &lt; 0): fFlyer = 0
            xcord3.append(fFlyer);
            ycord3.append(tats)

    fw.close()
    fig = plt.figure()
    ax = fig.add_subplot(111)
    # ax.scatter(xcord,ycord, c=colors, s=markers)
    type1 = ax.scatter(xcord1, ycord1, s=20, c='red')
    type2 = ax.scatter(xcord2, ycord2, s=30, c='green')
    type3 = ax.scatter(xcord3, ycord3, s=50, c='blue')
    ax.legend([type1, type2, type3], ["Did Not Like", "Liked in Small Doses", "Liked in Large Doses"], loc=2)
    ax.axis([-5000, 100000, -2, 25])
    plt.xlabel('Frequent Flyier Miles Earned Per Year')
    plt.ylabel('Percentage of Time Spent Playing Video Games')
    plt.show()

showNormal()
showLable()
showClass()
datingClassTest()
</code></pre>
				</p>
    </section>
</article>	<section id="comments">
				<div class="post-content">
			<div id="disqus_thread"></div>
			<script>
var disqus_config = function () {
	this.page.url = location.href;
	this.page.identifier = '536c2686d56006b5ca5e68da96ca855f';
};
(function() {
	var d = document, s = d.createElement('script');
	s.src = '//jimersylee.disqus.com/embed.js';
	s.setAttribute('data-timestamp', +new Date());
	(d.head || d.body).appendChild(s);
})();
			</script>
			<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		</div>
			</section>
</section>
    
    <footer id="pagefooter">
    <div class="footerwrap">
        <p class="siteinfo">Copyright &copy 2015 Gtiblog. All Rights Reserved. <a href="http://www.gitblog.cn">Proudly powered by Gitblog</a></p>
    </div>
</footer> 
</section>
        	<div class="clear"></div>
        </div>
    </section>

<link rel="stylesheet" href="//cdn.bootcss.com/highlight.js/8.6/styles/magula.min.css">
<script src="//cdn.bootcss.com/highlight.js/8.6/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});</script>
<script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.5.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

</body>
</html>
